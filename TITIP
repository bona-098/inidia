$("#scheduler").dxScheduler({
    dataSource: [],
    views: ["week", "month"],
    currentView: "week",
    currentDate: new Date(),
    firstDayOfWeek: 1,
    startDayHour: 8,
    endDayHour: 23,
    showAllDayPanel: false,
    height: 710,

    // Mencegah memilih tanggal yang tidak valid
    onCellClick: function (e) {
        const cellDate = new Date(e.cellData.startDate);
        let today = new Date();
        today.setHours(0, 0, 0, 0);

        let maxDate = new Date();
        maxDate.setDate(today.getDate() + 14);

        if (cellDate < today) {
            e.cancel = true;
            DevExpress.ui.notify("Tidak bisa memilih tanggal yang sudah lewat!", "warning", 3000);
        } else if (cellDate > maxDate) {
            e.cancel = true;
            DevExpress.ui.notify("Tidak bisa memilih tanggal lebih dari 14 hari ke depan!", "error", 3000);
        }
    },

    // Mengarsir cell yang tidak bisa dipilih (backdate & lebih dari H+14)
    cellTemplate: function (cellData, cellIndex, cellElement) {
        const cellDate = new Date(cellData.startDate);
        let today = new Date();
        today.setHours(0, 0, 0, 0);
        let maxDate = new Date();
        maxDate.setDate(today.getDate() + 14);

        if (cellDate < today || cellDate > maxDate) {
            $(cellElement).css({
                "background": "repeating-linear-gradient(45deg, #f8d7da, #f8d7da 10px, #ffffff 10px, #ffffff 20px)",
                "pointer-events": "none",
                "opacity": "0.5"
            });
        }
    }
});
