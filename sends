async function getTotalGuestsPerDay(appointments, roomId, startDate, endDate) {
    let dailyGuestCount = 0;

    appointments.forEach(appointment => {
        // Lewati booking yang statusnya REJECT (requestStatus == 4)
        if (appointment.requestStatus == 4) {
            console.log(`Skipping rejected booking ID: ${appointment.id}`);
            return;
        }

        let bookingStart = new Date(startDate);
        let bookingEnd = new Date(endDate);

        if (
            (appointment.ghm_room_id === roomId) &&
            (
                ((new Date(appointment.startDate) <= bookingEnd) && (new Date(appointment.startDate) > bookingStart)) ||
                ((new Date(appointment.endDate) <= bookingEnd) && (new Date(appointment.endDate) > bookingStart))
            )
        ) {
            console.log("Valid booking found:", appointment);

            let guestCount = safeArray(appointment.guest).length;
            let familyCount = safeArray(appointment.family).length;
            let employeeCount = safeArray(appointment.employee).length;
            let totalGuests = guestCount + familyCount + employeeCount;

            dailyGuestCount = (dailyGuestCount || 0) + totalGuests;
            console.log("Updated dailyGuestCount:", dailyGuestCount);
        }
    });

    return dailyGuestCount;
}
